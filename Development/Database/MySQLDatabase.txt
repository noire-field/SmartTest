CREATE TABLE IF NOT EXISTS Users ( 
	UserID INT NOT NULL AUTO_INCREMENT,
	Username VARCHAR(32) NOT NULL,
	Password VARCHAR(128) NOT NULL,
	Email VARCHAR(64) NOT NULL,
	FirstName VARCHAR(64),
	LastName VARCHAR(64),
	RoleType INT NOT NULL DEFAULT '0',
	RegisteredDate DATETIME,
	AvatarFile VARCHAR(64),
	StudentID VARCHAR(32),
	
	PRIMARY KEY(UserID)
);

CREATE TABLE IF NOT EXISTS Subjects (
	SubjectID INT NOT NULL AUTO_INCREMENT,
	SubjectName VARCHAR(128) NOT NULL,
	OwnerID INT NOT NULL,
	
	PRIMARY KEY(SubjectID)
);

CREATE TABLE IF NOT EXISTS Questions (
	QuestID INT NOT NULL AUTO_INCREMENT,
	SubjectID INT NOT NULL,
	QuestContent TEXT,
	ImageUrl VARCHAR(128),
	OwnerID INT NOT NULL,
	
	PRIMARY KEY(QuestID)
);

CREATE TABLE IF NOT EXISTS Answers (
	AnsID INT NOT NULL AUTO_INCREMENT,
	QuestID INT NOT NULL,
	AnsType INT NOT NULL DEFAULT '0',
	AnsContent TEXT,
	ImageUrl VARCHAR(128),
	IsCorrect BIT DEFAULT 0,
	
	PRIMARY KEY(AnsID)
);

CREATE TABLE IF NOT EXISTS Tags (
	TagID INT NOT NULL AUTO_INCREMENT,
	TagName VARCHAR(128) NOT NULL,
	
	PRIMARY KEY(TagID)
);

CREATE TABLE IF NOT EXISTS QuestTags (
	QuestTagID INT NOT NULL AUTO_INCREMENT,
	QuestID INT NOT NULL,
	TagID INT NOT NULL,
	
	PRIMARY KEY(QuestTagID)
);

CREATE TABLE IF NOT EXISTS Tests (
	TestID INT NOT NULL AUTO_INCREMENT,
	PINCode VARCHAR(8) NOT NULL,
	TestName VARCHAR(64) NOT NULL,
	TestTime INT NOT NULL,
	StartTime DATETIME NOT NULL,
	QuestTotal INT,
	OpenStatus INT NOT NULL DEFAULT '0',
	OwnerID INT NOT NULL,
	
	PRIMARY KEY(TestID)
);

CREATE TABLE IF NOT EXISTS TestParts (
	TestPartID INT NOT NULL AUTO_INCREMENT,
	TestID INT NOT NULL,
	PartName VARCHAR(64),
	
	PRIMARY KEY(TestPartID)
);

CREATE TABLE IF NOT EXISTS PartQuests (
	PartQuestID INT NOT NULL AUTO_INCREMENT,
	TestPartID INT NOT NULL,
	QuestID INT NOT NULL,
	
	PRIMARY KEY(PartQuestID)
);

CREATE TABLE IF NOT EXISTS StudentTests (
	StuTestID INT NOT NULL AUTO_INCREMENT,
	UserID INT NOT NULL,
	TestID INT NOT NULL,
	JoinedDate DATETIME,
	
	PRIMARY KEY(StuTestID)
);

CREATE TABLE IF NOT EXISTS StudentTestQuests (
	StuTestQuestID INT NOT NULL AUTO_INCREMENT,
	UserID INT NOT NULL,
	PartQuestID INT NOT NULL,
	AnsID INT NOT NULL,
	
	PRIMARY KEY(StuTestQuestID)
);